#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
plot(datasubset$response~datasubset$predictor, xlab="internet users", ylab="healthy life exp.")
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
predicted=predict(mod)
points(predictor, predicted, col="blue", add=T)
length(predicted)
points(datasubset$predictor, predicted, col="blue", add=T)
sum((datasubset$response-predicted)^2)
datasubset$response
predicted
sum((datasubset$response-predicted)^2)
sse=sum((datasubset$response-predicted)^2)
ssm=sum((predicted-mean(datasubset$response))^2)
ssm
varmod=sse/sst
varmod
1-sse/sst
varmod=1-sse/sst
summary(mod)
summary(mod)
response=hdi$Healthy.life.expectancy
predictor=hdi$Internet.users..Total....of.population.
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
```
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
response=hdi$Healthy.life.expectancy
predictor=hdi$Internet.users..Total....of.population.
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
```
nrow(datasubset)
plot(datasubset$response~datasubset$predictor, xlab="internet users", ylab="healthy life exp.")
summary(mod)
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
summary(mod)
response=hdi$Healthy.life.expectancy
predictor=hdi$Logged.GDP.per.capita#Internet.users..Total....of.population.
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
plot(datasubset$response~datasubset$predictor, xlab="internet users", ylab="healthy life exp.")
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
summary(mod)
response=hdi$Internet.users..Total....of.population.
predictor=hdi$Logged.GDP.per.capita
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
plot(datasubset$response~datasubset$predictor, xlab="internet users", ylab="healthy life exp.")
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
summary(mod)
response=hdi$Healthy.life.expectancy
predictor=hdi$Logged.GDP.per.capita#Internet.users..Total....of.population.
#response=hdi$Internet.users..Total....of.population.
predictor=hdi$Gender.Inequality.Index#Logged.GDP.per.capita
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
plot(datasubset$response~datasubset$predictor, xlab="internet users", ylab="healthy life exp.")
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
summary(mod)
summary(mod)
summary((datasubset$predictor))
f=(sse/1)/(sse/(length(datasubset$predictor-2)))
f
length(datasubset$predictor-2)
sulength(datasubset$predictor-#1. import the data
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
#1. import the data
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
test=cor(hdi[,c(3:ncol(hdi))], use="pairwise.complete.obs")
write.csv(test,"test.csv")
plot(test)
# Show the name of the variables in alphabetical order
sort(names(hdi))
#2. Extract variables of interest from the data
response=hdi$Healthy.life.expectancy
predictor=hdi$Internet.users..Total....of.population.
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
response=hdi$Healthy.life.expectancy
predictor=hdi$Internet.users..Total....of.population.
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
plot(datasubset$response~datasubset$predictor, xlab="internet users", ylab="healthy life exp.")
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
summary(mod)
predicted=predict(mod)
points(datasubset$predictor, predicted, col="blue", add=T)
sse=sum((datasubset$response-predicted)^2)
points(datasubset$predictor, predicted, col="blue")
ssm=sum((predicted-mean(datasubset$response))^2)
ssm
varmod=1-sse/sst
summary(mod)
varmod
f=(sse/1)/(sse/(length(datasubset$predictor-2)
)))
f=(sse/1)/(sse/(length(datasubset$predictor-2)))
f
sse
f=(ssm/1)/(sse/(length(datasubset$predictor-2)))
f
length(datasubset$predictor-2
)
f=(ssm/1)/(sse/141)
f
length(datasubset$predictor
)
summary(datasubset$predictor)
summary(datasubset$response)
length(datasubset$predictor-2)
length(datasubset$predictor)-2
f=(ssm/1)/(sse/(length(datasubset$predictor)-2)))
f=(ssm/1)/(sse/(length(datasubset$predictor)-2))
f
pf(f,1,length(datasubset$predictor)-2))
pf(f,1,length(datasubset$predictor)-2)
pf(f,1,length(datasubset$predictor)-2)
f
?pf
length(datasubset$predictor)-2
pf(f,1,length(datasubset$predictor)-2)
pf(f,1,length(datasubset$predictor)-2, lower.tail=FALSE)
summary(mod)
f
length(datasubset$predictor)-2
pf(f,1,length(datasubset$predictor)-2, lower.tail=FALSE)/2
pf(f,1,length(datasubset$predictor)-2, lower.tail=FALSE)
F
f
pf(27.36, 1,5)
1-pf(27.36, 1,5)
1-pf(f,1,length(datasubset$predictor)-2, lower.tail=FALSE)
pf(f,1,length(datasubset$predictor)-2, lower.tail=FALSE)
1-pf(f,1,length(datasubset$predictor)-2, lower.tail=FALSE)
summary(mod)
f
sqrt(1-.7171)*sd(datasubset$response)
varmod
sqrt(1-varmod)*sd(datasubset$response)
var(datasubset$response)
sqrt(sse/((length(datasubset$response)-1)*sum(datasubset$predictor-mean(datasubset$predictor))^2)
)
sse
sum(datasubset$predictor-mean(datasubset$predictor))^2
mean(datasubset$predictor)
sqrt(sse/((length(datasubset$response)-1)*sum((datasubset$predictor-mean(datasubset$predictor))^2)))
se=sqrt(sse/(length(datasubset$response)-2))
se
sb=se/sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2))
sb
tval=0.19836/sb
tval
mod$coefficients[[2]]
tval=mod$coefficients[[2]]/sb
pt(tval,length(datasubset$response)-2)
1-pt(tval,length(datasubset$response)-2)
pt(tval,length(datasubset$response)-2, lower.tail=FALSE)
1-((sse/(length(datasubset$response)-1))/((sst/length(datasubset$response)-1)))
varmod
1-(1-varmod)*(length(datasubset$response)-1)/(length(datasubset$response)-2)
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
wd=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/2023Spring/Module11_Correlation")
setwd(wd)
# This is an additional directory where I have the data stored
datadir=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/Datasets")
dir()
wd=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/2023Spring/Module11_Correlation")
setwd(wd)
# This is an additional directory where I have the data stored
datadir=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/Datasets")
dir()
#1. import the data
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
test=cor(hdi[,c(3:ncol(hdi))], use="pairwise.complete.obs")
write.csv(test,"test.csv")
plot(test)
# Show the name of the variables in alphabetical order
sort(names(hdi))
#2. Extract variables of interest from the data
response=hdi$Healthy.life.expectancy
predictor=hdi$Gender.Inequality.Index
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
# 5. Visualize the correlation
```{r include = TRUE, message=F, warning=F, eval=FALSE}
datadir=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/Datasets")
dir()
#1. import the data
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
plot(test)
response=hdi$Healthy.life.expectancy
predictor=hdi$Gender.Inequality.Index
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
plot(datasubset$response~datasubset$predictor, xlab="Gender Inequality Index", ylab="healthy life exp.")
#0. Setup environment
wd=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/2023Spring/Module11_Correlation")
setwd(wd)
# This is an additional directory where I have the data stored
datadir=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/Datasets")
dir()
#1. import the data
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
#2. Extract variables of interest from the data
response=hdi$Healthy.life.expectancy
predictor=hdi$Gender.Inequality.Index
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
# 5. Visualize the correlation
```{r include = TRUE, message=F, warning=F, eval=FALSE}
abline(mod)
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
summary(mod)
summary(mod)
wd=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/2023Spring/Module11_Correlation")
setwd(wd)
# This is an additional directory where I have the data stored
datadir=("/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Courses/Stats/Datasets")
dir()
hdi=read.csv(paste0(datadir, "/UNHDI_2020_w_Happiness.csv"))
#2. Extract variables of interest from the data
response=hdi$Healthy.life.expectancy
predictor=hdi$Internet.users..Total....of.population.
head(response)
summary(response)
head(predictor)
summary(predictor)
#3. Create a dataframe with the extracted variables
datasubset=data.frame(cbind(response,predictor))
#4. Remove observations with missing data
nrow(datasubset)
datasubset=subset(datasubset, complete.cases(datasubset))
summary(datasubset)
nrow(datasubset)
plot(datasubset$response~datasubset$predictor, xlab="internet users", ylab="healthy life exp.")
mod=lm(datasubset$response~datasubset$predictor)
abline(mod)
cor(datasubset$response, datasubset$predictor, method="pearson" )
r=sum((datasubset$predictor-mean(datasubset$predictor)^2)*(datasubset$response-mean(datasubset$response)^2))
r
sum((datasubset$predictor-mean(datasubset$predictor)^2)*(datasubset$response-mean(datasubset$response)^2))/sqrt(sum(datasubset$predictor-mean(datasubset$predictor)^2)*sum(datasubset$response-mean(datasubset$response)^2))
sum((datasubset$predictor-mean(datasubset$predictor)^2)*(datasubset$response-mean(datasubset$response)^2)))/sqrt(sum(datasubset$predictor-mean(datasubset$predictor)^2)*sum(datasubset$response-mean(datasubset$response))^2)
sum(((datasubset$predictor-mean(datasubset$predictor))^2)*(datasubset$response-mean(datasubset$response))^2))/sqrt(sum(datasubset$predictor-mean(datasubset$predictor)^2)*sum(datasubset$response-mean(datasubset$response))^2)
sum(((datasubset$predictor-mean(datasubset$predictor))^2)*
(datasubset$response-mean(datasubset$response))^2)
sqrt(sum(datasubset$predictor-mean(datasubset$predictor)^2)
*sum(datasubset$response-mean(datasubset$response))^2)
summary(datasubset$predictor)
table(datasubset$predictor)
mean(datasubset$predictor)
sum(datasubset$predictor-mean(datasubset$predictor)^2)
sum(datasubset$response-mean(datasubset$response))^2
sqrt(sum(datasubset$predictor-mean(datasubset$predictor)^2)
*sum(datasubset$response-mean(datasubset$response))^2)
sum(datasubset$predictor-mean(datasubset$predictor))^2))
sum((datasubset$predictor-mean(datasubset$predictor))^2)
sum((datasubset$predictor-mean(datasubset$predictor))^2
)
sum((datasubset$response-mean(datasubset$response))^2)
sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2)
*sum((datasubset$response-mean(datasubset$response))^2))
sum(((datasubset$predictor-mean(datasubset$predictor))^2)*
(datasubset$response-mean(datasubset$response))^2)/
sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2)
*sum((datasubset$response-mean(datasubset$response))^2))
((datasubset$predictor-mean(datasubset$predictor))^2)*
((datasubset$response-mean(datasubset$response))^2
)
um(((datasubset$predictor-mean(datasubset$predictor))^2)*
((datasubset$response-mean(datasubset$response))^2))/
sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2)
*sum((datasubset$response-mean(datasubset$response))^2))
sum(((datasubset$predictor-mean(datasubset$predictor))^2)*
((datasubset$response-mean(datasubset$response))^2))/
sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2)
*sum((datasubset$response-mean(datasubset$response))^2))
sum(((datasubset$predictor-mean(datasubset$predictor))^2)*
((datasubset$response-mean(datasubset$response))^2))
sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2)
*sum((datasubset$response-mean(datasubset$response))^2))
((datasubset$predictor-mean(datasubset$predictor))^2)*
((datasubset$response-mean(datasubset$response))^2)
sum((datasubset$predictor-mean(datasubset$predictor))^2)
sum((datasubset$response-mean(datasubset$response))^2)
((datasubset$predictor-mean(datasubset$predictor))^2)
((datasubset$response-mean(datasubset$response))^2)
sum((datasubset$predictor-mean(datasubset$predictor))*
(datasubset$response-mean(datasubset$response)))/
sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2)
*sum((datasubset$response-mean(datasubset$response))^2))
cor(datasubset$response, datasubset$predictor, method="pearson" )
summary(mod)
53.816+0.198*80
mod$coefficients
mod$coefficients[[2]]
mod$coefficients[[1]]+mod$coefficients[[2]]*80
predict(80, mod)
?predict
predict(mod, 80)
predict(mod, data.frame(c(80)))
ata.frame(c(80))
data.frame(c(80))
predict(mod, data.frame(c(80)))
data.frame(x=80))
data.frame(x=80)
predict(mod, data.frame(x=80)))
predict(mod, data.frame(x=80))
mod$coefficients[[1]]+mod$coefficients[[2]]*80
mod
x <- rnorm(15)
y <- x + rnorm(15)
new <- data.frame(x = seq(-3, 3, 0.5))
predict(lm(y ~ x), new, se.fit = TRUE)
new
iuval=80
mod$coefficients[[1]]+mod$coefficients[[2]]*iuval
predict(mod, data.frame(x=iuval))
predict(mod, data.frame(x=iuval). se.fit=TRUE)
predict(mod, data.frame(x=iuval), se.fit=TRUE)
mod$coefficients[[1]]+mod$coefficients[[2]]*iuval
iuval=20
hle80=53.816+0.198*iuval
# Extracting the values of the parameters from the model results
hle80v2=mod$coefficients[[1]]+mod$coefficients[[2]]*iuval
hle80v2
iuval=80
hle80=53.816+0.198*iuval
# Extracting the values of the parameters from the model results
hle80v2=mod$coefficients[[1]]+mod$coefficients[[2]]*iuval
hle80v2
iuval=20
hle20=53.816+0.198*iuval
# Extracting the values of the parameters from the model results
hle20v2=mod$coefficients[[1]]+mod$coefficients[[2]]*iuval
hle20v2
iuval=20
delta_hle=mod$coefficients[[2]]*iuval
delta_hle
(hleVal/mod$coefficients[[2]])-mod$coefficients[[1]]
hleVal=60
(hleVal/mod$coefficients[[2]])-mod$coefficients[[1]]
(hleVal-mod$coefficients[[1]])//mod$coefficients[[2]])
(hleVal-mod$coefficients[[1]])/mod$coefficients[[2]])
(hleVal-mod$coefficients[[1]])/mod$coefficients[[2]]
mod$coefficients[[2]]
mod$coefficients[[1]]
(hleVal-mod$coefficients[[1]])/mod$coefficients[[2]]
fig2path=paste(wd, "R2_Lab11", sep="/")
sst=sum((mean(datasubset$response)-datasubset$response)^2, na.rm = TRUE)
predicted=predict(mod)
points(datasubset$predictor, predicted, col="blue")
sse=sum((datasubset$response-predicted)^2)
ssr=sum((predicted-mean(datasubset$response))^2)
varmod=1-sse/sst
varmod
summary(mod)
ssr/sst
1-sse/sst
mod$qr
summary(mod)
mod$residuals
R2
ssr/sst
summary(mod)
1-(1-R2)*(length(datasubset$response)-1)/(length(datasubset$response)-2)
R2=1-sse/sst
1-(1-R2)*(length(datasubset$response)-1)/(length(datasubset$response)-2)
summary(mod)
(ssr/1)/(sse/(length(datasubset$predictor)-2))
f
f=(ssr/1)/(sse/(length(datasubset$predictor)-2))
f
summary(mod)
length(datasubset$predictor)-2
R2
(R2/1)/((1-R2)/(length(datasubset$predictor)-2))
(ssr/1)/(sse/(length(datasubset$predictor)-2))
se=sqrt(sse/(length(datasubset$response)-2))
sb=se/sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2))
tval=mod$coefficients[[2]]/sb
tval
pt(tval,length(datasubset$response)-2, lower.tail=FALSE)
pt(tval,length(datasubset$response)-2, lower.tail=FALSE)*2
?pt
qt(0.975,n-2, lower.tail=FALSE)
qt(0.975, length(datasubset$response)-2), lower.tail=FALSE)
length(datasubset$response)-2
qt(0.975, length(datasubset$response)-2, lower.tail=FALSE)
mod$coefficients[[2]]-qt(0.975, length(datasubset$response)-2, lower.tail=FALSE))
mod$coefficients[[2]]-qt(0.975, length(datasubset$response)-2, lower.tail=FALSE)
summary(mod)
mod$coefficients[[2]]-qt(0.975, length(datasubset$predictor)-2, lower.tail=FALSE)*
se/sd(datasubset$predictor)
mod$coefficients[[2]]+qt(0.975, length(datasubset$predictor)-2, lower.tail=FALSE)*
se/sd(datasubset$predictor)
wd="/Users/tug61163/Library/CloudStorage/OneDrive-TempleUniversity/Repositories/Gitrepo/IntroStatsCode/StatsLab1Images"
setwd(wd)
dir)()
dir()
R2
r^2
r
r=sum((datasubset$predictor-mean(datasubset$predictor))*
(datasubset$response-mean(datasubset$response)))/
sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2)
*sum((datasubset$response-mean(datasubset$response))^2))
r
r^2
R2
r^2
se=sqrt(sse/(length(datasubset$response)-2))
tval=mod$coefficients[[2]]/(se/sqrt(sum((datasubset$predictor-mean(datasubset$predictor))^2))
)
tval
summary(mod)
pt(tval,length(datasubset$response)-2, lower.tail=FALSE)*2
